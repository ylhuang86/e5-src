<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
</head>
<body>
	<form id="save" action="memo" method="POST" enctype="multipart/form-data">
		<div>
			<input id="myfile" type="file" />
		</div>
		<textarea rows="10" cols="100" name="fileContent" id="fileContent"></textarea>
		<div id="submitbutton">
			<button type="submit">Save!</button>
		</div>
	</form>
    <script>
		window.onload = function(){
			document.getElementById('myfile').onchange = readFile;
		};
		
		function readFile(){
			//console.log("in1");
			file = this.files[0];
			var fReader = new FileReader();
			fReader.readAsText(file);
			fReader.onload = function(e){
				document.getElementById('fileContent').value = e.target.result;
				//console.log("in2");
			};
		}
		
		/*window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;
		var fs = null;
		
		function errorHandler(e) {
		  var msg = '';

		  switch (e.code) {
			case FileError.QUOTA_EXCEEDED_ERR:
			  msg = 'QUOTA_EXCEEDED_ERR';
			  break;
			case FileError.NOT_FOUND_ERR:
			  msg = 'NOT_FOUND_ERR';
			  break;
			case FileError.SECURITY_ERR:
			  msg = 'SECURITY_ERR';
			  break;
			case FileError.INVALID_MODIFICATION_ERR:
			  msg = 'INVALID_MODIFICATION_ERR';
			  break;
			case FileError.INVALID_STATE_ERR:
			  msg = 'INVALID_STATE_ERR';
			  break;
			default:
			  msg = 'Unknown Error';
			  break;
		  };

		  console.log('Error: ' + msg);
		}
		
		function initFS() {
			window.requestFileSystem(window.TEMPORARY, 1024*1024, 
				function(filesystem) {
					fs = filesystem;
				}, errorHandler);
		}
		if (window.requestFileSystem) {
			initFS();
		}*/
		//window.requestFileSystem(window.TEMPORARY, 1024*1024, onInitFs, errorHandler);
		//function Save(e){
			/*console.log("in Save");
			var filename = document.getElementById('myfile').value;
			console.log(filename);
			var text = document.getElementById('fileContent').value;
			console.log(text);

			  fs.root.getFile(filename, {create: true}, function(fileEntry) {

				// Create a FileWriter object for our FileEntry (log.txt).
				fileEntry.createWriter(function(fileWriter) {

				  fileWriter.onwriteend = function(e) {
					console.log('Write completed.');
				  };

				  fileWriter.onerror = function(e) {
					console.log('Write failed: ' + e.toString());
				  };

				  // Create a new Blob and write it to log.txt.
				  var bb = new BlobBuilder(); 
				 // Note: window.WebKitBlobBuilder.
				  bb.append(text);
				  
				  fileWriter.write(bb.getBlob('text/plain'));

				}, errorHandler);

			  }, errorHandler);
			*/
		//}
		//document.getElementById('save').addEventListener('click', Save);
		
	</script>
    
</body>
</html>

